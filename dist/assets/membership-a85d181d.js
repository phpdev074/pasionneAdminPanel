import{P as s,r as n,j as e,S as O,T as K,I as le,v as A,w as ce,M as G,B as de,x as ue,W as he}from"./index-4f470b80.js";import{a as W}from"./axios-9cbf0d09.js";import{b as J}from"./axios-c4247b21.js";import{T as I,a as d,b as me,c as pe,d as ge,e as fe,f as xe}from"./TableSortLabel-278869ba.js";import{D as R,a as w,b as U,c as B,S as je}from"./DialogTitle-924059e0.js";import{D as be}from"./DialogContentText-833c681d.js";import{B as x}from"./Button-9fa635bc.js";import{T as u}from"./TextField-b51843b5.js";import{C as Ce}from"./Container-e4a2ede8.js";import{C as Se}from"./Card-5879615a.js";import{P as ye}from"./Pagination-87a9360e.js";import"./useId-5cbb1d54.js";import"./OutlinedInput-d1a306e0.js";import"./formControlState-7cecdb99.js";import"./isMuiElement-bcd6aaf2.js";import"./Menu-27e3df69.js";import"./useControlled-b58863b4.js";s.string;function Q({selected:o,_id:l,name:m,onModification:j,price:b,duration:a,discountPrice:S,offers:P,features:f}){const[T,y]=n.useState(null),[g,C]=n.useState(""),[D,k]=n.useState(!1),[v,p]=n.useState(!1),[M,F]=n.useState(m),[t,i]=n.useState(b),[c,Y]=n.useState(a),[z,Z]=n.useState(S),[q,ee]=n.useState(P),[H,te]=n.useState(f),se=r=>{y(r.currentTarget)},$=()=>{y(null)},ne=()=>{p(!0),$()},L=()=>{p(!1)},re=()=>{k(!0)},N=()=>{k(!1)},ae=async()=>{var r;N();try{const h=localStorage.getItem("token");if(!h){console.error("No token found");return}const E=await W.delete(`${J}testimonial/delete-membership`,{headers:{Authorization:`${h}`},data:{id:l}});E.data.statusCode===200?(C("Membership deleted successfully."),j()):console.error("Failed to delete membership:",E)}catch(h){console.error("Error deleting membership:",((r=h.response)==null?void 0:r.data)||h.message)}},ie=async()=>{var r;try{const h=localStorage.getItem("token");if(!h){console.error("No token found");return}const E={id:l,name:M,price:t,duration:c,discountPrice:z,offers:q,features:H},_=await W.put(`${J}testimonial/update-membership`,E,{headers:{Authorization:`${h}`}});_.data.statusCode===200?(C("Membership updated successfully."),j(),p(!1)):console.error("Failed to update membership:",_)}catch(h){console.error("Error updating membership:",((r=h.response)==null?void 0:r.data)||h.message)}},oe=()=>{C("")};return e.jsxs(e.Fragment,{children:[e.jsxs(I,{hover:!0,tabIndex:-1,role:"checkbox",selected:o,children:[e.jsx(d,{padding:"checkbox",children:" "}),e.jsx(d,{align:"center",children:e.jsx(O,{direction:"row",alignItems:"center",spacing:1,children:e.jsx(K,{variant:"subtitle2",noWrap:!0,children:m})})}),e.jsx(d,{children:b}),e.jsx(d,{children:a}),e.jsx(d,{children:S}),e.jsx(d,{children:P}),e.jsx(d,{children:f}),e.jsx(d,{align:"right",children:e.jsx(le,{onClick:se,children:e.jsx(A,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(ce,{open:!!T,anchorEl:T,onClose:$,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(G,{onClick:ne,children:[e.jsx(A,{icon:"eva:edit-outline",sx:{mr:2}}),"Edit"]}),e.jsxs(G,{onClick:re,sx:{color:"error.main"},children:[e.jsx(A,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]}),e.jsxs(R,{open:D,onClose:N,children:[e.jsx(w,{children:"Confirm Delete"}),e.jsx(U,{children:e.jsx(be,{children:"Are you sure you want to delete this membership?"})}),e.jsxs(B,{children:[e.jsx(x,{onClick:N,color:"primary",children:"Cancel"}),e.jsx(x,{onClick:ae,color:"error",autoFocus:!0,children:"Delete"})]})]}),e.jsxs(R,{open:v,onClose:L,children:[e.jsx(w,{children:"Edit Membership"}),e.jsxs(U,{sx:{mt:3},children:[" ",e.jsxs(O,{spacing:2,sx:{width:600},children:[e.jsx(u,{fullWidth:!0,label:"Name",value:M,onChange:r=>F(r.target.value)}),e.jsx(u,{fullWidth:!0,label:"Price",value:t,onChange:r=>i(r.target.value)}),e.jsx(u,{fullWidth:!0,label:"Duration",value:c,onChange:r=>Y(r.target.value)}),e.jsx(u,{fullWidth:!0,label:"Discount Price",value:z,onChange:r=>Z(r.target.value)}),e.jsx(u,{fullWidth:!0,label:"Offers",value:q,onChange:r=>ee(r.target.value)}),e.jsx(u,{fullWidth:!0,label:"Features",value:H,onChange:r=>te(r.target.value)})]})]}),e.jsxs(B,{children:[e.jsx(x,{onClick:L,color:"primary",children:"Cancel"}),e.jsx(x,{onClick:ie,color:"success",autoFocus:!0,children:"Save Changes"})]})]}),e.jsx(je,{open:!!g,autoHideDuration:6e3,onClose:oe,message:g})]})}Q.propTypes={name:s.string.isRequired,_id:s.string.isRequired,selected:s.bool,onModification:s.func.isRequired,price:s.oneOfType([s.string,s.number]),duration:s.oneOfType([s.string,s.number]),discountPrice:s.oneOfType([s.string,s.number]),offers:s.string,features:s.string};const De={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function V({order:o,orderBy:l,headLabel:m,onRequestSort:j}){const b=a=>S=>{j(S,a)};return e.jsx(me,{children:e.jsxs(I,{children:[e.jsx(d,{padding:"checkbox",children:" "}),m.map(a=>e.jsx(d,{align:a.align||"left",sortDirection:l===a.id?o:!1,sx:{width:a.width,minWidth:a.minWidth},children:e.jsxs(pe,{hideSortIcon:!0,active:l===a.id,direction:l===a.id?o:"asc",onClick:b(a.id),children:[a.label,l===a.id?e.jsx(de,{sx:{...De},children:o==="desc"?"sorted descending":"sorted ascending"}):null]})},a.id))]})})}V.propTypes={order:s.oneOf(["asc","desc"]),orderBy:s.string,headLabel:s.array,onRequestSort:s.func};function X({emptyRows:o,height:l}){return o?e.jsx(I,{sx:{...l&&{height:l*o}},children:e.jsx(d,{colSpan:9})}):null}X.propTypes={emptyRows:s.number,height:s.number};function ve(){const[o,l]=n.useState(1),[m,j]=n.useState([]),[b]=n.useState("asc"),[a,S]=n.useState([]),[P]=n.useState("name");n.useState("");const[f]=n.useState(10),[T,y]=n.useState(!1),[g,C]=n.useState({name:"",price:"",duration:"",discountPrice:"",offers:"",features:""}),D=async()=>{var i;const t=localStorage.getItem("token");if(!t){console.error("No token found");return}try{const c=await W.get("https://pasionneapi.codingacademy.world/api/testimonial/get-membership-plan",{headers:{Authorization:t}});j((i=c==null?void 0:c.data)==null?void 0:i.data)}catch(c){console.error("Error fetching user data:",c.message),alert(c.message)}};n.useEffect(()=>{D()},[]);const k=()=>y(!0),v=()=>{y(!1),C({name:"",price:"",duration:"",discountPrice:"",offers:"",features:""})},p=t=>{C({...g,[t.target.name]:t.target.value})},M=async()=>{try{const t={...g,price:Number(g.price),discountPrice:Number(g.discountPrice),offers:g.offers.split(",").map(i=>i.trim()),features:g.features.split(",").map(i=>i.trim())};await W.post("https://pasionneapi.codingacademy.world/api/testimonial//create-membership",t,{headers:{Authorization:localStorage.getItem("token")}}),v(),D()}catch(t){console.error("Error adding membership:",t.message)}},F=(t,i)=>{l(i)};return e.jsxs(Ce,{children:[e.jsxs(O,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(K,{variant:"h4",children:"Membership"}),e.jsx(x,{variant:"contained",color:"primary",onClick:k,children:"Add Membership"})]}),e.jsxs(Se,{children:[e.jsx(ue,{children:e.jsx(ge,{sx:{overflow:"unset"},children:e.jsxs(fe,{sx:{minWidth:800},children:[e.jsx(V,{order:b,orderBy:P,rowCount:m.length,numSelected:a.length,headLabel:[{id:"name",label:"Name"},{id:"price",label:"Price"},{id:"duration",label:"Duration"},{id:"discountPrice",label:"Discount Price"},{id:"offers",label:"Offers"},{id:"features",label:"Features"},{id:"action",label:""}]}),e.jsxs(xe,{children:[m.length>0?m.slice((o-1)*f,o*f).map(t=>{var i,c;return e.jsx(Q,{name:t==null?void 0:t.name,price:t==null?void 0:t.price,duration:t.duration,discountPrice:t.discountPrice,offers:(i=t.offers)==null?void 0:i.join(", "),features:(c=t.features)==null?void 0:c.join(", "),_id:t._id,avatarUrl:t.userImage,userType:t.userType,selected:a.indexOf(t.name)!==-1,onModification:D},t._id)}):e.jsx(I,{children:e.jsx(d,{colSpan:7,align:"center",children:e.jsx("div",{style:{marginTop:"10%",fontWeight:"bold"},children:"No Data Found"})})}),e.jsx(X,{height:77,emptyRows:f-m.length%f})]})]})})}),e.jsx(O,{alignItems:"center",mt:2,mb:2,children:e.jsx(ye,{count:Math.ceil(m.length/f),page:o,onChange:F,color:"primary"})})]}),e.jsxs(R,{open:T,onClose:v,children:[e.jsx(w,{children:"Add Membership"}),e.jsxs(U,{children:[e.jsx(u,{name:"name",label:"Name",fullWidth:!0,margin:"normal",onChange:p}),e.jsx(u,{name:"price",label:"Price",type:"number",fullWidth:!0,margin:"normal",onChange:p}),e.jsx(u,{name:"duration",label:"Duration",fullWidth:!0,margin:"normal",onChange:p}),e.jsx(u,{name:"discountPrice",label:"Discount Price",type:"number",fullWidth:!0,margin:"normal",onChange:p}),e.jsx(u,{name:"offers",label:"Offers ",fullWidth:!0,margin:"normal",onChange:p}),e.jsx(u,{name:"features",label:"Features",fullWidth:!0,margin:"normal",onChange:p})]}),e.jsxs(B,{children:[e.jsx(x,{onClick:v,children:"Cancel"}),e.jsx(x,{onClick:M,color:"primary",children:"Add"})]})]})]})}function He(){return e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsx("title",{children:" MemeberShip "})}),e.jsx(ve,{})]})}export{He as default};
